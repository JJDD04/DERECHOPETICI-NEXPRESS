<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Derecho de Petici√≥n</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #e3f2fd, #f5f5f5);
  padding: 20px;
}

.container {
  max-width: 760px;
  margin: auto;
  background: #ffffff;
  padding: 30px;
  border-radius: 10px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

h1 {
  text-align: center;
  margin-bottom: 10px;
}

.section-title {
  margin-top: 30px;
  font-size: 18px;
  color: #1976d2;
  border-bottom: 2px solid #e0e0e0;
  padding-bottom: 5px;
}

label {
  font-weight: bold;
  display: block;
  margin-top: 15px;
}

small {
  font-weight: normal;
  color: #666;
}

input, textarea {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 14px;
}

input:focus, textarea:focus {
  outline: none;
  border-color: #1976d2;
}

button {
  margin-top: 25px;
  padding: 14px;
  width: 100%;
  background: #1976d2;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  cursor: pointer;
}

button:hover {
  background: #125aa3;
}

.hidden { display:none; }

.box {
  background:#f7f7f7;
  padding:15px;
  border-radius:8px;
  margin-top:15px;
  font-size: 14px;
}
</style>
</head>

<body>

<div class="container">
<h1>Derecho de Petici√≥n</h1>
<p style="text-align:center; color:#555;">
Completa la informaci√≥n con cuidado. Entre m√°s claro seas, mejor ser√° el documento.
</p>

<form id="formulario" novalidate>

<!-- ================= PANTALLA 1 ================= -->
<div id="pantalla1">

  <div class="section-title">Datos del solicitante</div>

  <label>Nombre completo</label>
  <input type="text" name="nombre" required>

  <label>C√©dula</label>
  <input type="text" name="cedula" required>

  <label>Ciudad de residencia</label>
  <input type="text" name="ciudad" required>

  <label>Correo electr√≥nico</label>
  <input type="email" name="correo" required>

  <div class="section-title">Entidad o empresa a la que se dirige</div>

  <label>Nombre de la empresa o entidad</label>
  <input type="text" name="entidad" required>

  <label>NIT o RUT de la empresa <small>(si lo conoces)</small></label>
  <input type="text" name="nit_empresa">

  <label>Ciudad de la empresa <small>(opcional)</small></label>
  <input type="text" name="ciudad_empresa">

  <div class="section-title">Descripci√≥n del caso</div>

  <label>
    Describe tu problema
    <small>
      S√© directo y espec√≠fico. Incluye fechas, n√∫meros de contrato, radicados,
      nombres de funcionarios y qu√© respuesta esperas.
    </small>
  </label>
  <textarea name="caso" rows="7" required></textarea>

  <button type="button" onclick="irAPago()">Continuar al pago</button>
</div>

<!-- ================= PANTALLA 2 ================= -->
<div id="pantalla2" class="hidden">

  <div class="section-title">Pago del servicio</div>

  <div class="box">
    <b>üíú Nequi</b><br>
    3102201651
  </div>

  <div class="box">
    <b>üè¶ Bancolombia</b><br>
    Nombre: JUAN JOSE DAZA<br>
    C√©dula: 1014868216<br>
    Cuenta de ahorros: 944-692959-01
  </div>

  <label>
    Link del comprobante de pago
    <small>
      Sube el comprobante a Google Drive, OneDrive o similar y pega el enlace aqu√≠.
    </small>
  </label>
  <input type="url" name="link_comprobante" required
         placeholder="https://drive.google.com/...">

  <button type="submit">Generar derecho de petici√≥n</button>

  <p id="estado" style="margin-top:15px;"></p>
</div>

</form>
</div>

<script>
emailjs.init("jvc-7-lDgJoYTiYQj");

const URL_SCRIPT =
"https://script.google.com/macros/s/AKfycbwfxnYbxFntDUFzO6-2CtzAqFhpAQsp6p4N_vj-oyXmnBSQjNggZOXisbqpUi3dWVk9/exec";

function irAPago() {
  document.getElementById("pantalla1").classList.add("hidden");
  document.getElementById("pantalla2").classList.remove("hidden");
}

document.getElementById("formulario").addEventListener("submit", async function(e) {
  e.preventDefault();

  const estado = document.getElementById("estado");
  estado.innerText = "‚è≥ Generando documento...";

  const formData = new FormData(this);

  try {
    const response = await fetch(URL_SCRIPT, {
      method: "POST",
      body: formData,
      redirect: "follow"
    });

    const texto = await response.text();
    const data = JSON.parse(texto);

    if (!data.ok || !data.url) {
      estado.innerText = "‚ùå No se pudo generar el documento";
      return;
    }

    window.open(data.url, "_blank");

    emailjs.send("service_a16hrta", "template_m8d80fi", Object.fromEntries(formData))
      .finally(() => {
        estado.innerText = "‚úÖ Documento generado correctamente.";
      });

  } catch {
    estado.innerText = "‚ùå Error de conexi√≥n";
  }
});
</script>

</body>
</html>

